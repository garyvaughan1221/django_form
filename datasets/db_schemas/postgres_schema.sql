/*
 1. I used the .csv files in the parent folder of this file to populate the database.
 2. The models will be updated later on to reflect foreign key relationships.
 3. MongoDB schema is in a different file.
*/

create table public.national (
  id bigint generated by default as identity not null,
  "GroupCode" text not null,
  "GroupName" text not null,
  "Congregations" integer null,
  "Adherents" integer null,
  "Adherents_percent_of_Total_Adherents" real null,
  "Adherents_percent_of_Population" real null,
  constraint Summary_pkey primary key (id)
) TABLESPACE pg_default;


create table public.by_state (
  id bigint generated by default as identity not null,
  "StateCode" text not null,
  "GroupCode" text not null,
  "GroupName" text not null,
  "Congregations" integer null,
  "Adherents" integer null,
  "Adherents_percent_of_Total_Adherents" real null,
  "Adherents_percent_of_Population" real null,
  constraint state_pkey primary key (id),
  constraint by_state_StateCode_fkey foreign KEY ("StateCode") references "stateNames" ("StateCode")
) TABLESPACE pg_default;

create table public.by_county (
  id bigint generated by default as identity not null,
  "StateCode" text not null,
  "FIPS" integer not null,
  "CountyName" text not null,
  "GroupCode" text not null,
  "GroupName" text not null,
  "Congregations" integer null,
  "Adherents" integer null,
  "Adherents_percent_of_Total_Adherents" real null,
  "Adherents_percent_of_Population" real null,
  constraint bycounty_pkey primary key (id),
  constraint by_county_StateCode_fkey foreign KEY ("StateCode") references "stateNames" ("StateCode")
) TABLESPACE pg_default;


create table public.county_names (
  "StateCode" text not null,
  "CountyName" text not null,
  "FIPS" integer not null,
  constraint county_names_StateCode_fkey foreign KEY ("StateCode") references "stateNames" ("StateCode")
) TABLESPACE pg_default;



create table public.stateNames (
  "StateCode" text not null,
  "StateName" text not null,
  constraint stateNames_pkey primary key ("StateCode"),
  constraint stateNames_StateCode_key unique ("StateCode")
) TABLESPACE pg_default;




-- There is a problem with the metro data.  The FIPS codes do not align with distinct County names.
-- Therefore, we are not implementing the metro table at this time.  But if you want it, there it is.

-- create table public.by_metro (
--   id bigint generated by default as identity not null,
--   "CBSACode" integer null,
--   "GroupCode" text not null,
--   "GroupName" text not null,
--   "Congregations" integer null,
--   "Adherents" integer null,
--   "Adherents_percent_of_Total_Adherents" real null,
--   "Adherents_percent_of_Population" real null,
--   "MetroName" text not null,
--   constraint Metro_pkey primary key (id)
-- ) TABLESPACE pg_default;





-- The summary table was dropped because it can be hardcoded as a JSON blob.








