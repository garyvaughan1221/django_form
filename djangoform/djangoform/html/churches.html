{% load humanize %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>

<style>
    div.wrapper {
        display: block;

        > div {
            display: inline-block;
            vertical-align: top;
        }
        div.col1 {
            width: 300px;
            margin-right: 50px;
        }
        div.col2 {
            width: 50%;
        }
    }
    div.field {
        margin-bottom: 15px;
    }
    label {
        display: block;
        font-weight: bold;
        margin-bottom: 3px;
    }
    form {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 20px;
        width: 300px;
    }
    input {
        border-radius: 9px;
        font-size: 16px;
        margin: 10px 0;
        padding: 8px;
    }
    input[type="submit"] {
        background-color: #475c8a;
        border: none;
        color: white;
        cursor: pointer;
        padding: 10px 15px;

        &:hover {
            background-color: #3067dd;
        }
    }

    table#queryHdr {
        background-color: #ccc;
        font-style: normal;

        td:last-child{
            color: blue;
        }
    }
    table {
        width: 100%;
        padding: 3px;

        td {
            padding: 5px;
            vertical-align: top;
        }

        tr.classI {
            td {
                background-color: #efe9e9;
                color: #0f0f10;
                font-style: italic;
                font-weight: normal;
            }
        }
    }

    table#summaryData {
        td:first-child {
            font-weight: bold;
            /* white-space: nowrap; */
        }
        td:last-child {
            color: rgb(22, 10, 75)
        }
    }

    table#nationalData {
        td:first-child {
            color: blue;
        }
        tr.hdrCols td {
            background-color: #ecf5a7;
            color: #000;
            font-weight: bold;
        }
    }

    table#summaryData, table#nationalData {
        td.hdr {
            background-color: #777;
            color: #fff;
            text-align: center;
        }
    }


    p{
        margin: 0 0 37px;
    }
</style>


<div class="wrapper">
    <div class="col1">
        <form action = "" method = "post">
            {% csrf_token %}
            <div class="field">
                <label for="searchQuery">Search for a Church:</label>
                {{ form.searchQuery }}

                {% if form.searchQuery.errors %}
                    <p style="color: red;">{{ form.searchQuery.errors.as_text }}</p>
                {% endif %}
            </div>

            <div class="field">
                <select id="searchType" name="searchType" class="form-select">
                {% for value, label in form.ddlOptions %}
                <option value="{{ value }}" {% if value == selected_id %}selected{% endif %}>
                    {{ label }}
                </option>
                {% endfor %}
                </select>
            </div>

            <input type = "submit" value = "Submit">
    </form>
    </div>

    <div class="col2">
        {% if query is not None %}
        <table class="table" id="queryHdr">
            <tr class="classI">
                <td>Your search query:</td>
                <td>{{ query }}</td>
            </tr>
            <tr class="classI">
                <td>Your search type/region:</td>
                <td>{{ selected_id }}</td>
            </tr>
        </table>
        {% endif %}


        {% if summaryData is not None %}
        <table class="table" id="summaryData">
            <th scope="col">
                <tr>
                    <td colspan="2" class="hdr">2020 statistical data on US Church Organizations</td>
                </tr>
            </th>
            <tr>
                <td>
                    Population 2020:
                </td>
                <td>
                    {{ summaryData.Population_2020|intcomma }}
                </td>
            </tr>
            <tr>
                <td>
                    # of Congregations:
                </td>
                <td>
                    {{ summaryData.Congregations|intcomma }}
                </td>
            </tr>
            <tr>
                <td>Congregations per 1000 population:</td>
                <td>{{ summaryData.Congregations_per_1000_population }}</td>
            </tr>
            <tr>
                <td>
                    # of Adherents:
                </td>
                <td>
                    {{ summaryData.Adherents|intcomma }}
                </td>
            </tr>
            <tr>
                <td>
                    Adherents % of population:
                </td>
                <td>
                    {{ summaryData.Adherents_percent_of_Population }}%
                </td>
            </tr>
        </table>
        {% endif %}


        {% if nationalData is not None %}
        <table class="table" id="nationalData">
            <tr>
                <td colspan="3" class="hdr">2020 National US Church Organizations</td>
            </tr>
            <tr class="hdrCols">
                <td>
                    Group Name
                </td>
                <td>
                    Congregations
                </td>
                <td>
                    Adherents
                </td>
            </tr>
            {% for churchGroup in nationalData %}
                <tr>
                    <td>
                        {{ churchGroup.GroupName }}
                    </td>
                    <td>
                        {{ churchGroup.Congregations|intcomma }}
                    </td>
                    <td>
                        {{ churchGroup.Adherents|intcomma }}
                    </td>
                </tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>

</div><!-- end wrapper-->


